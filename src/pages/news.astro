---
// biome-ignore lint/correctness/noUnusedImports: used in Astro template below
import Layout from "../layouts/Layout.astro";

interface NewsEntry {
	date: string;
	day: string;
	title: string;
	body: string;
	type: "current" | "update";
}

// biome-ignore lint/correctness/noUnusedVariables: used in Astro template below
const entries: NewsEntry[] = [
	{
		date: "2026-02-18",
		day: "Tuesday",
		title: "Current Status",
		body: "ETA for services coming back online is late Friday or Saturday. Maybe even Sunday. I'm sorry friends :).",
		type: "current",
	},
	{
		date: "2026-02-18",
		day: "Tuesday",
		title: "Docker Compose & Network Tuning",
		body: "Finalized Docker Compose configurations for the full *arr stack. Tuned bridge networking and DNS resolution. All containers pulling and launching cleanly.",
		type: "update",
	},
	{
		date: "2026-02-17",
		day: "Monday",
		title: "Ubuntu VM & Security Hardening",
		body: "Provisioned Ubuntu Server VM on Unraid. Configured SSH hardening, firewall rules, and fail2ban. Migrated from authentik to TinyAuth reverse-proxy authentication layer.",
		type: "update",
	},
	{
		date: "2026-02-16",
		day: "Sunday",
		title: "Unraid Host Setup & Research",
		body: "Completed Unraid host configuration — shares, cache pools, parity check. Spun up initial Ubuntu VM. Spent time researching best practices for Docker-on-VM vs bare-metal containers.",
		type: "update",
	},
	{
		date: "2026-02-15",
		day: "Saturday",
		title: "Physical Migration to Supermicro SC847",
		body: "Moved all drives and parts into the new Supermicro SC847 chassis. Debugged HBA card passthrough issues — reseated cards and updated firmware. All 24 bays now recognized.",
		type: "update",
	},
	{
		date: "2026-02-14",
		day: "Friday",
		title: "Backups & Boot Drive Prep",
		body: "Ran full backups of Plex metadata, databases, and *arr configurations. Prepared Unraid USB boot drive and validated license. Server taken offline.",
		type: "update",
	},
];

// biome-ignore lint/correctness/noUnusedVariables: used in Astro template below
function formatDate(date: string, day: string): string {
	const d = new Date(`${date}T00:00:00`);
	const month = d.toLocaleString("en-US", { month: "short" }).toUpperCase();
	const dayNum = d.getDate();
	return `${month} ${dayNum} — ${day.toUpperCase()}`;
}
---

<Layout title="CCCP.PS — News">
	<section class="news" aria-label="News">
		<h1 class="page-title">NEWS</h1>
		<hr class="news-divider" aria-hidden="true" />

		<div class="timeline" role="list">
			{entries.map((entry, i) => (
				<div
					class:list={["timeline-entry", { "is-current": entry.type === "current" }]}
					role="listitem"
					style={`animation-delay: ${0.1 + i * 0.08}s`}
				>
					<div class="timeline-marker" aria-hidden="true">
						<span class:list={["timeline-dot", { "dot-current": entry.type === "current" }]} />
					</div>
					<div class="timeline-content">
						<time class="timeline-date" datetime={entry.date}>
							[{formatDate(entry.date, entry.day)}]
						</time>
						<h2 class="timeline-title">{entry.title}</h2>
						<p class="timeline-body">{entry.body}</p>
					</div>
				</div>
			))}
		</div>
	</section>
</Layout>

<style>
	.news {
		width: 100%;
		max-width: 600px;
		margin-top: 1rem;
		margin-bottom: 2rem;
	}

	.page-title {
		font-family: 'Bebas Neue', sans-serif;
		font-size: clamp(2rem, 5vw, 3rem);
		letter-spacing: 0.25em;
		font-weight: 400;
		color: #e8e6e3;
		text-align: center;
		margin-bottom: 1rem;
	}

	.news-divider {
		border: none;
		border-top: 1px solid #1a1a1d;
		margin-bottom: 3rem;
	}

	.timeline {
		position: relative;
		padding-left: 1.5rem;
	}

	/* Vertical line */
	.timeline::before {
		content: '';
		position: absolute;
		left: 4px;
		top: 8px;
		bottom: 8px;
		width: 1px;
		background: #1a1a1d;
	}

	.timeline-entry {
		position: relative;
		display: flex;
		gap: 1.5rem;
		padding-bottom: 2.5rem;
		animation: fade-up 0.5s ease-out both;
	}

	.timeline-entry:last-child {
		padding-bottom: 0;
	}

	@keyframes fade-up {
		from {
			opacity: 0;
			transform: translateY(12px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	/* Marker */
	.timeline-marker {
		position: absolute;
		left: -1.5rem;
		top: 6px;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.timeline-dot {
		display: block;
		width: 9px;
		height: 9px;
		border-radius: 50%;
		background: #2a2a2d;
		border: 1px solid #3a3a3d;
	}

	.dot-current {
		background: #c9434d;
		border-color: #c9434d;
		box-shadow: 0 0 8px rgba(201, 67, 77, 0.5);
		animation: pulse-dot 2s ease-in-out infinite;
	}

	@keyframes pulse-dot {
		0%, 100% { opacity: 1; box-shadow: 0 0 8px rgba(201, 67, 77, 0.5); }
		50% { opacity: 0.5; box-shadow: 0 0 14px rgba(201, 67, 77, 0.7); }
	}

	/* Content */
	.timeline-content {
		text-align: left;
		min-width: 0;
	}

	.timeline-date {
		display: block;
		font-size: 0.7rem;
		letter-spacing: 0.12em;
		color: #4a484f;
		margin-bottom: 0.5rem;
		font-family: 'JetBrains Mono', monospace;
	}

	.timeline-title {
		font-family: 'JetBrains Mono', monospace;
		font-size: 1rem;
		font-weight: 500;
		color: #7a7880;
		margin-bottom: 0.5rem;
	}

	.timeline-body {
		font-size: 0.85rem;
		line-height: 1.65;
		color: #5a585f;
	}

	/* Current entry highlight */
	.is-current .timeline-title {
		color: #e8e6e3;
	}

	.is-current .timeline-body {
		color: #e8e6e3;
	}

	.is-current .timeline-content {
		padding-left: 1rem;
		border-left: 2px solid rgba(201, 67, 77, 0.5);
	}

	/* Reduced motion */
	@media (prefers-reduced-motion: reduce) {
		.timeline-entry { animation: none; }
		.dot-current { animation: none; box-shadow: 0 0 8px rgba(201, 67, 77, 0.5); }
	}
</style>